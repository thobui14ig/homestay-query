import{e as g,r as a,j as e,K as p}from"./index-8d785817.js";import{b as u}from"./comment.api-351767ad.js";import{t as f}from"./time-4bc6cbf8.js";function h(){const{socket:r,userInfo:l}=g(),[n,c]=a.useState([]);a.useEffect(()=>(r.emit("join-room-comment-tiktok",{userId:l.id}),r.on("comment-tiktok",t=>{console.log(t),!n.find(m=>m.postId==t.postId&&m.commentCreatedAt==t.commentCreatedAt)&&(n.length==50&&n.pop(),n.unshift(t),c([...n]))}),()=>{r.emit("leave-room-comment-tiktok"),r.off("comment-tiktok")}),[r]),a.useEffect(()=>{const t=async()=>{const x=(await u()).data.sort((s,i)=>new Date(i.timeCreated).getTime()-new Date(s.timeCreated).getTime()).map(s=>({commentId:s.cmtId,userNameComment:String(s.name),commentMessage:String(s.message),phoneNumber:s.phoneNumber,userIdComment:s.uid,commentCreatedAt:s.timeCreated,postId:s.postId,userId:s.userId}));c(x)};t();const o=setInterval(t,5e3);return()=>clearInterval(o)},[]);const d=t=>{window.open(`https://www.tiktok.com/@dangnamtravelblog/video/${t}`,"_blank")};return e.jsx("div",{className:"p-4 flex flex-col gap-4",children:n.map((t,o)=>e.jsxs("div",{className:`rounded-2xl shadow-md p-4 flex flex-col gap-2 ${o===0||o===2?"bg-cyan-100":"bg-white"}`,children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h3",{className:"font-semibold text-lg text-gray-800",children:[t.userNameComment,e.jsxs("span",{children:["(",f(t.commentCreatedAt),")"]})]}),e.jsx("span",{className:"text-blue-600 font-bold",children:"Tiktok"})]}),e.jsx("div",{className:"text-sm text-gray-600"}),e.jsx("p",{className:"text-gray-800 text-sm sm:text-base",children:t.commentMessage}),e.jsxs("div",{className:"flex justify-between mt-2 text-sm",children:[e.jsx("button",{className:"flex items-center gap-1 px-3 py-1 rounded-xl bg-pink-100 hover:bg-pink-200",children:"Gọi"}),e.jsx("button",{className:"flex items-center gap-1 px-3 py-1 rounded-xl bg-gray-100 hover:bg-gray-200",children:"Nhắn"}),e.jsx("button",{className:"flex items-center gap-1 px-3 py-1 rounded-xl bg-gray-100 hover:bg-gray-200",onClick:()=>{d(t.postId)},children:"Xem"}),e.jsx("button",{className:"p-2 rounded-xl bg-gray-100 hover:bg-gray-200"})]})]},o))})}function C(){return e.jsx(p,{children:e.jsx(h,{})})}export{C as default};
