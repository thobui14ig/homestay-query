import{e as l,r as m,j as e,K as x}from"./index-099867fa.js";import{b as g}from"./comment.api-821e7b11.js";import{t as p}from"./time-b318a354.js";function u(){const{socket:r,userInfo:i}=l(),[n,a]=m.useState([]);m.useEffect(()=>(r.emit("join-room-comment-tiktok",{userId:i.id}),r.on("comment-tiktok",s=>{console.log(s),!n.find(t=>t.postId==s.postId&&t.commentCreatedAt==s.commentCreatedAt)&&(n.length==50&&n.pop(),n.unshift(s),a([...n]))}),()=>{r.emit("leave-room-comment-tiktok"),r.off("comment-tiktok")}),[r]),m.useEffect(()=>{(async()=>{const o=(await g()).data.sort((t,c)=>new Date(c.timeCreated).getTime()-new Date(t.timeCreated).getTime()).map(t=>({commentId:t.cmtId,userNameComment:String(t.name),commentMessage:String(t.message),phoneNumber:t.phoneNumber,userIdComment:t.uid,commentCreatedAt:t.timeCreated,postId:t.postId,userId:t.userId}));a(o)})()},[]);const d=s=>{window.open(`https://www.tiktok.com/@dangnamtravelblog/video/${s}`,"_blank")};return e.jsx("div",{className:"p-4 flex flex-col gap-4",children:n.map((s,o)=>e.jsxs("div",{className:`rounded-2xl shadow-md p-4 flex flex-col gap-2 ${o===0||o===2?"bg-cyan-100":"bg-white"}`,children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h3",{className:"font-semibold text-lg text-gray-800",children:[s.userNameComment,e.jsxs("span",{children:["(",p(s.commentCreatedAt),")"]})]}),e.jsx("span",{className:"text-blue-600 font-bold",children:"Tiktok"})]}),e.jsx("div",{className:"text-sm text-gray-600"}),e.jsx("p",{className:"text-gray-800 text-sm sm:text-base",children:s.commentMessage}),e.jsxs("div",{className:"flex justify-between mt-2 text-sm",children:[e.jsx("button",{className:"flex items-center gap-1 px-3 py-1 rounded-xl bg-pink-100 hover:bg-pink-200",children:"Gọi"}),e.jsx("button",{className:"flex items-center gap-1 px-3 py-1 rounded-xl bg-gray-100 hover:bg-gray-200",children:"Nhắn"}),e.jsx("button",{className:"flex items-center gap-1 px-3 py-1 rounded-xl bg-gray-100 hover:bg-gray-200",onClick:()=>{d(s.postId)},children:"Xem"}),e.jsx("button",{className:"p-2 rounded-xl bg-gray-100 hover:bg-gray-200"})]})]},o))})}function k(){return e.jsx(x,{children:e.jsx(u,{})})}export{k as default};
