import{j as t,h as f,r as l,Q as k,e as D,g as I,K as R}from"./index-298daa61.js";import{T as L,B as C,u as K,a as y,b,I as S,S as V,M as H}from"./index.esm-a963dcad.js";import{M as w,c as T,D as N}from"./toast-3c8d1654.js";import{P as $}from"./Pagination-43e5b98e.js";import"./motion-77d779e8.js";import"./index-5a4807ea.js";function X({width:e=18,height:r=18}){return t.jsx("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 576 512",height:e,width:r,xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{d:"M402.3 344.9l32-32c5-5 13.7-1.5 13.7 5.7V464c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h273.5c7.1 0 10.7 8.6 5.7 13.7l-32 32c-1.5 1.5-3.5 2.3-5.7 2.3H48v352h352V350.5c0-2.1.8-4.1 2.3-5.6zm156.6-201.8L296.3 405.7l-90.4 10c-26.2 2.9-48.5-19.2-45.6-45.6l10-90.4L432.9 17.1c22.9-22.9 59.9-22.9 82.7 0l43.2 43.2c22.9 22.9 22.9 60 .1 82.8zM460.1 174L402 115.9 216.2 301.8l-7.3 65.3 65.3-7.3L460.1 174zm64.8-79.7l-43.2-43.2c-4.1-4.1-10.8-4.1-14.8 0L436 82l58.1 58.1 30.9-30.9c4-4.2 4-10.8-.1-14.9z"})})}const q=e=>f.post("/links",e),F=(e,r)=>f.post("/links/query",{limit:e,offset:r}),Q=e=>f.delete(`/links/${e}`),W=e=>f.put("/links",e);var M=(e=>(e.Pending="pending",e.Started="started",e))(M||{});const _=({setIsModalOpen:e,isModalOpen:r,isReload:d,setIsReload:u})=>{const[i,o]=l.useState(""),p=async()=>{if(i.length===0){k.error("Nội dung không được trống!");return}const h={links:i.split(`
`).map(a=>a.trim()).filter(a=>a.length>0).map(a=>{const g=a.split("|");return{url:g[0],name:g[1],delayTime:1}}),status:M.Started,hideCmt:!1,thread:1,tablePageId:null};try{const a=await q(h);o(""),e(!1),u(!d),k(a.data.message)}catch(a){T(a)}},c=()=>p();return t.jsx(w,{title:"Add link",closable:{"aria-label":"Custom Close Button"},open:r,onOk:()=>c(),onCancel:()=>e(!1),children:t.jsx(L,{onChange:m=>{o(m.target.value)},rows:4})})},G=({setIsModalOpen:e,isModalOpen:r,isReload:d,setIsReload:u,link:i})=>{const o=async()=>{if(i.linkUrl.length===0){k.error("Nội dung không được trống!");return}try{e(!1),u(!d),k("Update thành công!"),await W(i)}catch(c){T(c)}},p=()=>o();return t.jsx(w,{title:"Edit link",closable:{"aria-label":"Custom Close Button"},open:r,onOk:()=>p(),onCancel:()=>e(!1),children:t.jsx(L,{"aria-label":"Url",defaultValue:i.linkUrl,onChange:c=>{i.linkUrl=c.target.value},rows:4})})};function J(){const{optionsReactTableDefault:e}=D(),[r,d]=l.useState(!1),[u,i]=l.useState(!1),[o,p]=l.useState(null),[c,m]=l.useState(null),[h,a]=l.useState(!1),[g,E]=l.useState(0),[x,A]=l.useState(50),[O,v]=l.useState(0);l.useEffect(()=>{(async()=>{const n=await F(x,x*(g?g-1:0));p(n.data.data),v(n.data.totalCount)})()},[h,g,x]);const z=l.useMemo(()=>[{header:"Url",accessorKey:"linkUrl",size:100,Cell:n=>{const s=n.row.original.linkUrl;return s&&s.length>100?`${(s??"").slice(0,100)}...`:s??"Trống"}},{header:"Content",accessorKey:"content",size:200,Cell:n=>{const s=n.row.original.content;return s&&s.length>100?`${(s??"").slice(0,100)}...`:s??"Trống"}},{header:"Status",accessorKey:"type",size:50,muiTableHeadCellProps:{sx:{p:0,m:0,width:"50px"}},muiTableBodyCellProps:{sx:{p:0,m:0,width:"50px"}},Cell:n=>{const s=n.row.original.type,j=B(s);return t.jsx(t.Fragment,{children:t.jsx(C,{type:"primary",children:j})})}}],[]),B=n=>{let s="Đang chờ";return n==="die"?"Die":n==="private"||n==="public"?"Live":s},U=K({columns:z,data:o??[],...e,enableBottomToolbar:!0,initialState:{...e.initialState},state:{isLoading:!o},renderRowActions:({row:n})=>t.jsxs(y,{sx:{display:"flex",gap:"1rem"},children:[t.jsx(C,{type:"primary",children:"Xem"}),t.jsx(b,{title:"Edit",children:t.jsx(S,{onClick:()=>{i(!0);const s=(o??[]).find(j=>j.id==n.original.id);s&&m(s)},children:t.jsx(X,{})})}),t.jsx(b,{title:"Delete",children:t.jsx(S,{color:"error",onClick:()=>{P(n.original.id)},children:t.jsx(N,{})})}),t.jsx("button",{className:"text-primary",children:"Comments"})]}),renderTopToolbarCustomActions:()=>t.jsx(C,{type:"primary",onClick:()=>{d(!0)},children:"Add"}),renderBottomToolbar:()=>t.jsx(y,{sx:{p:1,display:"flex",justifyContent:"flex-end"},children:t.jsx($,{pageSize:x,setPage:E,setPageSize:A,totalCount:O,pageSizeOptions:["50","100","200"],setData:p})})}),P=async n=>{I("Xóa thành công!"),await Q(n),a(!h)};return t.jsxs(V,{gap:"1rem",children:[t.jsx(H,{table:U}),r&&t.jsx(_,{setIsModalOpen:d,isModalOpen:r,isReload:h,setIsReload:a}),u&&c&&t.jsx(G,{setIsModalOpen:i,isModalOpen:u,isReload:h,setIsReload:a,link:c})]})}function at(){return t.jsx(R,{children:t.jsx(J,{})})}export{at as default};
