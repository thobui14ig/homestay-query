import{j as t,h as f,r as l,Q as k,e as I,g as R,K}from"./index-0db84d6a.js";import{T as L,B as C,u as N,a as y,b,I as S,S as U,M as V}from"./index.esm-c360f4a7.js";import{M as w,c as M,D as H}from"./toast-1c981d54.js";import{P as X}from"./Pagination-3c6cc32c.js";import"./motion-582f0d84.js";import"./index-858a489e.js";function $({width:e=18,height:r=18}){return t.jsx("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 576 512",height:e,width:r,xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{d:"M402.3 344.9l32-32c5-5 13.7-1.5 13.7 5.7V464c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h273.5c7.1 0 10.7 8.6 5.7 13.7l-32 32c-1.5 1.5-3.5 2.3-5.7 2.3H48v352h352V350.5c0-2.1.8-4.1 2.3-5.6zm156.6-201.8L296.3 405.7l-90.4 10c-26.2 2.9-48.5-19.2-45.6-45.6l10-90.4L432.9 17.1c22.9-22.9 59.9-22.9 82.7 0l43.2 43.2c22.9 22.9 22.9 60 .1 82.8zM460.1 174L402 115.9 216.2 301.8l-7.3 65.3 65.3-7.3L460.1 174zm64.8-79.7l-43.2-43.2c-4.1-4.1-10.8-4.1-14.8 0L436 82l58.1 58.1 30.9-30.9c4-4.2 4-10.8-.1-14.9z"})})}const q=e=>f.post("/links",e),F=(e,r)=>f.post("/links/query",{limit:e,offset:r}),Q=e=>f.delete(`/links/${e}`),W=e=>f.put("/links",e);var T=(e=>(e.Pending="pending",e.Started="started",e))(T||{});const _=({setIsModalOpen:e,isModalOpen:r,isReload:d,setIsReload:u})=>{const[o,i]=l.useState(""),p=async()=>{if(o.length===0){k.error("Nội dung không được trống!");return}const h={links:o.split(`
`).map(n=>n.trim()).filter(n=>n.length>0).map(n=>{const m=n.split("|");return{url:m[0],name:m[1],delayTime:1}}),status:T.Started,hideCmt:!1,thread:1,tablePageId:null};try{const n=await q(h);i(""),e(!1),u(!d),k(n.data.message)}catch(n){M(n)}},c=()=>p();return t.jsx(w,{title:"Add link",closable:{"aria-label":"Custom Close Button"},open:r,onOk:()=>c(),onCancel:()=>e(!1),children:t.jsx(L,{onChange:g=>{i(g.target.value)},rows:4})})},G=({setIsModalOpen:e,isModalOpen:r,isReload:d,setIsReload:u,link:o})=>{const i=async()=>{if(o.linkUrl.length===0){k.error("Nội dung không được trống!");return}try{e(!1),u(!d),k("Update thành công!"),await W(o)}catch(c){M(c)}},p=()=>i();return t.jsx(w,{title:"Edit link",closable:{"aria-label":"Custom Close Button"},open:r,onOk:()=>p(),onCancel:()=>e(!1),children:t.jsx(L,{"aria-label":"Url",defaultValue:o.linkUrl,onChange:c=>{o.linkUrl=c.target.value},rows:4})})};function J(){const{optionsReactTableDefault:e}=I(),[r,d]=l.useState(!1),[u,o]=l.useState(!1),[i,p]=l.useState(null),[c,g]=l.useState(null),[h,n]=l.useState(!1),[m,E]=l.useState(0),[x,A]=l.useState(50),[O,v]=l.useState(0);l.useEffect(()=>{(async()=>{const s=await F(x,x*(m?m-1:0));p(s.data.data),v(s.data.totalCount)})()},[h,m,x]);const z=l.useMemo(()=>[{header:"Nguồn",accessorKey:"linkName",size:200},{header:"Content",accessorKey:"content",size:200,Cell:s=>{const a=s.row.original.content;return a&&a.length>100?`${(a??"").slice(0,100)}...`:a??"Trống"}},{header:"Status",accessorKey:"type",size:50,muiTableHeadCellProps:{sx:{p:0,m:0,width:"50px"}},muiTableBodyCellProps:{sx:{p:0,m:0,width:"50px"}},Cell:s=>{const a=s.row.original.type,j=B(a);return t.jsx(t.Fragment,{children:t.jsx(C,{type:"primary",children:j})})}}],[]),B=s=>{let a="Đang chờ";return s==="die"?"Die":s==="private"||s==="public"?"Live":a},P=N({columns:z,data:i??[],...e,enableBottomToolbar:!0,initialState:{...e.initialState},state:{isLoading:!i},renderRowActions:({row:s})=>t.jsxs(y,{sx:{display:"flex",gap:"1rem"},children:[t.jsx(C,{type:"primary",children:"Xem"}),t.jsx(b,{title:"Edit",children:t.jsx(S,{onClick:()=>{o(!0);const a=(i??[]).find(j=>j.id==s.original.id);a&&g(a)},children:t.jsx($,{})})}),t.jsx(b,{title:"Delete",children:t.jsx(S,{color:"error",onClick:()=>{D(s.original.id)},children:t.jsx(H,{})})}),t.jsx("button",{className:"text-primary",children:"Comments"})]}),renderTopToolbarCustomActions:()=>t.jsx(C,{type:"primary",onClick:()=>{d(!0)},children:"Add"}),renderBottomToolbar:()=>t.jsx(y,{sx:{p:1,display:"flex",justifyContent:"flex-end"},children:t.jsx(X,{pageSize:x,setPage:E,setPageSize:A,totalCount:O,pageSizeOptions:["50","100","200"],setData:p})})}),D=async s=>{R("Xóa thành công!"),await Q(s),n(!h)};return t.jsxs(U,{gap:"1rem",children:[t.jsx(V,{table:P}),r&&t.jsx(_,{setIsModalOpen:d,isModalOpen:r,isReload:h,setIsReload:n}),u&&c&&t.jsx(G,{setIsModalOpen:o,isModalOpen:u,isReload:h,setIsReload:n,link:c})]})}function at(){return t.jsx(K,{children:t.jsx(J,{})})}export{at as default};
